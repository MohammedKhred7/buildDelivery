import J from"./Bstm_ySF.js";import{_ as Q,s as W,r as o,k as X,O as Y,e as Z,K as P,c as _,a as t,b as n,d as ee,u as e,w as g,q as U,o as w,j as le,h as S,n as ae,v as se,I as ie}from"./DlpHkmL0.js";import te from"./D8lTbIT0.js";import E from"./DXAmTOlE.js";import{s as d}from"./DSdGnCYt.js";import N from"./CNniomjW.js";import"./CoxUqrR_.js";import{u as oe}from"./DqYQLfsE.js";import{u as ne}from"./BTNZ0bI1.js";import"./Bf4cEvKq.js";import"./bCRbFe0p.js";import"./BkU7aHfr.js";import"./BziMxfVr.js";import"./yzV4vvnb.js";import"./BLy7Cel3.js";import"./BAE139OP.js";import"./BFFb8TmC.js";import"./bdQok-YG.js";import"./CLlgUbV3.js";import"./IiVaVNxp.js";import"./CuVQF4ud.js";import"./xqRTRM5t.js";import"./B8u4s1tW.js";import"./B5bubvKh.js";import"./C8rbLGTx.js";import"./Ci_DL6Se.js";import"./DPbyJipG.js";import"./kFOV_SB1.js";import"./BEwNHn44.js";import"./Cpx0GLDo.js";const ue={class:"py-6 pl-6 pr-6"},ce={class:"icon-category"},re=["src"],de={class:"p-fluid p-0"},pe={class:"mb-4"},me={key:0,class:"flex justify-content-center"},fe=["src"],ve={key:1,class:"relative text-white mr-4",style:{top:"50px",left:"9px"}},ge={class:"flex justify-content-center gap-2"},ye={class:"flex justify-content-center gap-2 mt-4"},be={__name:"slider",setup(_e){ne({title:"إدارة شرائح الصفحة الرئيسية"});const{errorMessage:y,success:h}=W(),a=oe(),C=o(null),x=X(),{file:u,urlImage:I}=Y(x);Z(async()=>{a.GetAllSlides()});const V=o(!1),z=o(null),G=o(null),r=o(!1),c=o({id:1,images:[]}),p=o(!1),D=o(null);async function L(s){for(let l=0;l<a.allSlides.images.length;l++)a.allSlides.images[l]===s&&(D.value=l);c.value=a==null?void 0:a.allSlides.images,p.value=!0,u.value=null,r.value=!0}const v=o(!1);function M(){u.value=null,c.value=a==null?void 0:a.allSlides.images,v.value=!0,r.value=!0}const m=o(!1),$=o(null);function O(s){$.value=s,m.value=!0}const k=o(!1),T=()=>{k.value=!0;for(let s=0;s<a.allSlides.images.length;s++)a.allSlides.images[s]===$.value&&a.allSlides.images.splice(s,1);j(),m.value=!1};function q(s){u.value=s.files[0]}function H(){u.value=null}function K(){C.value.choose()}const f=o(!1);async function j(){f.value=!0;try{if(v.value){const l=await x.upladFiles(u.value);if(l)c.value.push(l);else{y("خطأ في رفع الملف"),f.value=!1;return}}else if(p.value){const l=await x.upladFiles(u.value);if(l)c.value[D.value]=l;else{y("خطأ في رفع الملف"),f.value=!1;return}}else k.value&&(c.value=a==null?void 0:a.allSlides.images);const s={id:1,images:[...c.value]};console.log("Sending payload:",s),await a.updateImageSlider(s),a.sucsses?(v.value?h("تم حفظ الصورة بنجاح"):p.value?h("تم تعديل الصورة بنجاح"):h("تم حذف الصورة بنجاح"),await a.GetAllSlides()):y("مشكلة في الاتصال"),v.value=!1,p.value=!1,k.value=!1,r.value=!1,u.value=null}catch(s){console.log(s),y("حدث خطأ غير متوقع")}finally{f.value=!1}}return P(V,s=>{s===!1&&(G.value=null,z.value=null)}),(s,l)=>{var F;const A=J;return w(),_("div",ue,[l[7]||(l[7]=t("div",{class:"main-title mb-4"},[t("h1",{class:"pb-3 pr-0"},[ee(" إدارة شرائح الصفحة الرئيسية "),t("i",{class:"pi pi-image pr-3"})])],-1)),t("div",null,[n(e(d),{label:"إضافة شريحة",class:"mb-3",severity:"success",onClick:M})]),n(e(te),{value:(F=e(a))==null?void 0:F.allSlides.images,rows:5,rowsPerPageOptions:[5,10,20,50],paginator:!0,class:"p-datatable-gridlines"},{default:g(()=>[n(e(E),{field:"images",header:"الصورة",style:{"justify-content":"center",display:"flex"}},{body:g(i=>[t("div",ce,[t("img",{src:e(I)+(i==null?void 0:i.data),alt:"icon",class:"w-full h-full"},null,8,re)])]),_:1}),n(e(E),{style:{"text-align":"start"},header:"إجراء"},{body:g(i=>[n(e(d),{label:"تعديل",icon:"pi pi-pencil",severity:"warning",class:"gap-2 ml-2",onClick:b=>L(i==null?void 0:i.data)},null,8,["onClick"]),n(e(d),{label:"حذف",icon:"pi pi-trash",severity:"danger",class:"gap-2 ml-2",onClick:b=>O(i==null?void 0:i.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value"]),n(e(N),{visible:e(r),"onUpdate:visible":l[1]||(l[1]=i=>U(r)?r.value=i:null),header:e(p)?"تعديل شريحة":"إضافة شريحة",modal:"",closable:!1,style:{width:"30rem",borderRadius:"24px"}},{default:g(()=>{var i,b,R,B;return[t("div",de,[t("div",pe,[le(n(A,{ref_key:"uploader",ref:C,class:ae(e(u)?"d-none":"justify-content-center "),name:"avatar",customUpload:"",accept:"image/*",maxFileSize:"1000000",auto:!1,multiple:!1,chooseLabel:"انقر لتحميل صورة",uploadLabel:"انقر لتحميل صورة",showUploadButton:!1,showCancelButton:!1,onSelect:q,onRemove:H},null,8,["class"]),[[se,e(u)]]),e(u)?S("",!0):(w(),_("div",me,[t("div",{class:"profileImage p-1",onClick:K},[(i=e(c))!=null&&i.id?(w(),_("img",{key:0,src:e(I)+((b=e(c))==null?void 0:b.id),alt:"انقر لتحميل صورة",style:{"border-radius":"50%",width:"100%",height:"100%","object-fit":"cover"}},null,8,fe)):S("",!0),(R=e(c))!=null&&R.id?S("",!0):(w(),_("span",ve,"انقر لتحميل صورة ")),t("span",{class:"iconCamera",style:ie({top:(B=e(c))!=null&&B.id?"-44px":"50px"})},l[4]||(l[4]=[t("i",{class:"pi pi-camera"},null,-1)]),4)])]))]),t("div",ge,[n(e(d),{label:e(v)?"اضافة":e(p)?"تحديث":"",icon:"pi pi-check pl-2",class:"w-50",severity:"success",onClick:j,loading:e(f)},null,8,["label","loading"]),n(e(d),{label:"إلغاء",icon:"pi pi-times pl-2",class:"cancel-btn w-50",onClick:l[0]||(l[0]=we=>r.value=!1)})])])]}),_:1},8,["visible","header"]),n(e(N),{visible:e(m),"onUpdate:visible":l[3]||(l[3]=i=>U(m)?m.value=i:null),modal:"",closable:!1,style:{width:"auto",textAlign:"center",borderRadius:"24px"}},{default:g(()=>[l[5]||(l[5]=t("h1",{class:"font-bold text-xl mb-2"},"حذف شريحة",-1)),l[6]||(l[6]=t("p",null,"هل أنت متأكد أنك تريد حذف شريحة ؟",-1)),t("div",ye,[n(e(d),{label:"تأكيد الحذف",icon:"pi pi-check",severity:"danger",class:"w-100",onClick:T,loading:e(f)},null,8,["loading"]),n(e(d),{label:"إلغاء",icon:"pi pi-times pl-2",class:"cancel-btn w-50",onClick:l[2]||(l[2]=i=>m.value=!1)})])]),_:1,__:[5,6]},8,["visible"])])}}},Ye=Q(be,[["__scopeId","data-v-53ce9667"]]);export{Ye as default};
