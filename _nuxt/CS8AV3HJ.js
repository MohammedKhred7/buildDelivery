import{_ as R,a as U}from"./BYL1yRL7.js";import{C as B,_ as F}from"./CMmYAGeI.js";import{_ as V}from"./NCH_zfc0.js";import q from"./CjvyA2IO.js";import{_ as E,k as G,s as M,q as Q,g as j,r as T,e as H,l as O,c as h,o as w,a as t,m as J,i as z,b as u,t as s,u as e,v as K,F as W,j as X,w as Y,x as Z}from"./BKzAI-Wm.js";import{_ as tt,a as et}from"./tehqhsS6.js";import{u as ot}from"./C4EaSLWD.js";import"./DENnix_4.js";import"./CAGqlqSm.js";import"./C0_8Y8II.js";import"./BaBzIy89.js";import"./q7OVjmMF.js";import"./DP3FlFFF.js";import"./CilANJHZ.js";import"./CAjwrcL4.js";import"./BpPbVGvO.js";import"./qUGvnqAa.js";import"./BOlN8jLb.js";import"./C6mr5iLD.js";import"./-PhekKT4.js";import"./C6x87e9G.js";const st={class:"container-xxl py-4 pr-2 pl-2"},nt={class:"mb-4 font-bold text-4xl"},at={class:"flex-column md:flex-row align-items-top row-gap-3"},lt={class:"col-12 col-md-8"},rt={class:"text-center mt-4"},it={class:"col-12 col-md-4"},ct={class:"summary-card p-4 rounded text-end"},mt={class:"font-bold mb-4"},ut={class:"summary-row mb-3"},dt={class:"summary-row mb-3"},_t={class:"summary-row mb-3"},pt={class:"summary-row mb-3"},ft={class:"summary-row mb-3"},vt={class:"summary-row total"},yt={key:0,class:"flex align-items-center"},bt={class:"font-bold delete-title text-enter text-900"},xt={class:"p-text-secondary"},ht={class:"flex justify-content-center gap-2"},wt={__name:"Cart",setup(L){const{t:n}=G(),l=M(),r=Q(),C=j(),D=T({price:0,estmatedTime:null,minutes:0,currency:null});H(async()=>{var o,p,c,_,m;const a=localStorage.getItem("user");if(a?r.ProfileUser=JSON.parse(a):r.ProfileUser={},((o=r.ProfileUser)==null?void 0:o.role)==="Client"&&!((p=r.DefaultLocation)!=null&&p.id)&&(r.DefaultLocation=await r.GetDefaultLocation(r.ProfileUser.id)),((c=l.items)==null?void 0:c.length)>0&&((_=r.DefaultLocation)!=null&&_.id)){let i={storeId:l.items[0].storeId,locationId:(m=r.DefaultLocation)==null?void 0:m.id};D.value=await r.GetDeliveryPriceAndTimeByAreaAndLocation(i)}});const d=O(()=>{var S;const a=l.items||[],o=Number(((S=D.value)==null?void 0:S.price)||0);let p=0,c=0,_=0,m=0;for(const x of a){const I=Number(x.quantity)||0,P=Number(x.price)||0,f=x.discountValue??0;let g=0;f>0&&f<=1?g=P*f:f>1&&f<=100?g=P*(f/100):g=Number(f)||0,p+=I,c+=P*I,_+=g*I}m=o;const y=c-_,i=y+m,b=x=>Math.round((x+Number.EPSILON)*100)/100;return{totalItems:p,totalProductPrice:b(c),totalDiscount:b(_),totalAfterDiscount:b(y),delivery:b(m),finalTotal:b(i)}}),N=a=>{l.addToCart(a)},$=a=>{l.decreaseQuantity(a==null?void 0:a.id)},k=T(null),v=T(!1),A=a=>{v.value=!0,k.value=a==null?void 0:a.id};return(a,o)=>{var m,y;const p=F,c=V,_=q;return w(),h("div",st,[t("h1",nt,s(e(n)("cart.title")),1),J(t("div",at,[t("div",lt,[(w(!0),h(W,null,X(e(l).items,i=>(w(),h("div",{key:i.id,class:"mb-3"},[u(B,{product:i,onIncrease:N,onDecrease:$,onRemove:A},null,8,["product"])]))),128)),t("div",rt,[t("button",{class:"add-product-btn w-100",onClick:o[0]||(o[0]=i=>{e(C).push("/cart/add-payment")})},s(e(n)("cart.go_to_payment")),1)])]),t("div",it,[t("div",ct,[t("h5",mt,s(e(n)("cart.summary_title")),1),t("div",ut,[t("span",null,s(e(n)("cart.summary_items")),1),t("span",null,s(e(d).totalItems),1)]),t("div",dt,[t("span",null,s(e(n)("cart.summary_total_before_discount")),1),t("span",null,s(e(d).totalProductPrice)+" ريـال",1)]),t("div",_t,[t("span",null,s(e(n)("cart.summary_total_discount")),1),t("span",null,s(e(d).totalDiscount)+" ريـال ",1)]),t("div",pt,[t("span",null,s(e(n)("cart.summary_after_discount")),1),t("span",null,s(e(d).totalAfterDiscount)+" ريـال ",1)]),t("div",ft,[t("span",null,s(e(n)("cart.summary_delivery_fee")),1),t("span",null,s(e(d).delivery)+" ريـال",1)]),o[5]||(o[5]=t("hr",{class:"my-3"},null,-1)),t("div",vt,[o[4]||(o[4]=t("span",null,"الإجمالي",-1)),t("span",null,s(e(d).finalTotal)+" ريـال",1)])])])],512),[[K,((m=e(l).items)==null?void 0:m.length)>0]]),((y=e(l).items)==null?void 0:y.length)<=0?(w(),h("div",yt,[u(p)])):z("",!0),u(_,{visible:e(v),"onUpdate:visible":o[3]||(o[3]=i=>Z(v)?v.value=i:null),closable:!1,modal:"",style:{width:"25rem",textAlign:"center",borderRadius:"24px"}},{default:Y(()=>[t("h1",bt,s(e(n)("cart.delete_title")),1),t("p",xt,s(e(n)("cart.delete_confirmation")),1),t("div",ht,[u(c,{class:"delete-btn w-50",type:"button",label:e(n)("yes"),severity:"secondary",onClick:o[1]||(o[1]=i=>(e(l).removeFromCart(e(k)),v.value=!1))},null,8,["label"]),u(c,{class:"cancel-btn w-50",type:"button",label:e(n)("cancel"),onClick:o[2]||(o[2]=i=>v.value=!1)},null,8,["label"])])]),_:1},8,["visible"])])}}},Dt=E(wt,[["__scopeId","data-v-44613ef6"]]),gt={class:"flex flex-column gap-6"},Ht={__name:"index",setup(L){return ot({title:"سلة المشتريات"}),(n,l)=>{const r=R,C=Dt,D=U,d=tt;return w(),h("div",null,[u(r,{id:"up"}),t("div",gt,[u(C),u(D)]),u(d,{onClicked:l[0]||(l[0]=N=>("scrollTo"in n?n.scrollTo:e(et))("up"))})])}}};export{Ht as default};
