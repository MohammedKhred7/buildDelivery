import U from"./9M8dpHiG.js";import S from"./Cyz3IbkO.js";import P from"./BvBnGFSF.js";import y from"./nNXtJv5v.js";import{s as p}from"./Csik62mt.js";import k from"./DyQk_v9T.js";import{u as E}from"./ChvpdQ6H.js";import{u as R}from"./D4LLzVUe.js";import{_ as B,s as G,e as K,r as d,K as j,c as L,a as s,b as i,d as M,u as r,w as A,o as H,t as D}from"./3DgHTrxd.js";import"./CGcx-d3k.js";import"./aFGx5zvu.js";import"./BtLHsEl4.js";import"./C22dDGv8.js";import"./CV-fhFDP.js";import"./kaH4JCU0.js";import"./DT-U6w7V.js";import"./COV_D4Z7.js";import"./CVdTRZe1.js";import"./OS1p232e.js";import"./G-RJ5_b5.js";import"./B9S46ozp.js";import"./BytGMRMg.js";import"./BLJqs125.js";import"./7yO1-c2y.js";import"./CoxauZdD.js";import"./D8I6fCk2.js";import"./BARx7_Hz.js";const O={class:"py-6 pr-6 pl-6"},Y={class:"flex-column gap-2 mb-4"},q={class:"flex-column gap-2 mb-4"},z={class:"flex-column gap-2 mb-4"},F={class:"flex-column gap-2 mb-4"},J={class:"flex justify-content-center gap-2"},Q={class:"flex justify-content-center gap-2"},W={__name:"deliverys",setup(X){E({title:"إدارة رسوم التوصيل"});const a=R(),{errorMessage:x,success:I}=G();K(async()=>{a.GetAllDeliveryPriceAndTimes()}),d([{id:1,name:"YER"},{id:2,name:"SAR"},{id:3,name:"USD"}]);function V(t){const e=String.fromCharCode(t.keyCode);/[0-9]/.test(e)||t.preventDefault()}const v=d(!1),n=d(null),g=d(null);async function N(t){g.value=t;let e=await a.allDelivery.findIndex(u=>u.id===t);n.value=e,v.value=!0}const c=d(!1),l=d({id:null,estmatedTime:"",currency:"",fromArea:{},fromAreaId:null,toArea:{},toAreaId:null,price:null});d(null);async function T(){l.value={id:null,estmatedTime:"",currency:"",fromArea:{},fromAreaId:null,toArea:{},toAreaId:null,price:null},a.GetAllArea(),n.value=null,c.value=!0}async function _(t){l.value={...t},a.GetAllArea();let e=await a.allDelivery.findIndex(u=>u.id===l.value.id);n.value=e,c.value=!0}async function w(t){var e;return((e=a.allArea.find(u=>u.id===t))==null?void 0:e.areaName)||" - "}async function h(){f.value=!0;try{if(n.value===null){const t=await a.CreateDeliveryPriceAndTime(l.value);a.sucsses?(l.value.fromArea={},l.value.toArea={},l.value.fromArea.areaName=await w(l.value.fromAreaId),l.value.toArea.areaName=await w(l.value.toAreaId),l.value.fromArea.id=l.value.fromAreaId,l.value.toArea.id=l.value.toAreaId,l.value.id=t==null?void 0:t.id,I("تم إضافة رسوم التوصيل جديد  بنجاح"),a.allDelivery.push(l.value)):x("مشكلة في الاتصال")}else l.value.fromArea.areaName=await w(l.value.fromAreaId),l.value.toArea.areaName=await w(l.value.toAreaId),l.value.fromArea.id=l.value.fromAreaId,l.value.toArea.id=l.value.toAreaId,await a.UpdateDeliveryPriceAndTime(l.value),a.sucsses?(I("تم تعديل رسوم التوصيل جديد  بنجاح"),a.allDelivery.splice(n.value,1,{...l.value})):x("مشكلة في الاتصال");a.sucsses=!1,c.value=!1}catch(t){console.log(t)}finally{f.value=!1}}const f=d(!1);async function $(){f.value=!0;try{n.value!==null&&(await a.DeleteDeliveryPriceAndTime(g.value),a.sucsses?(I("تم حذف رسوم التوصيل  بنجاح"),a.allDelivery.splice(n.value,1)):x("مشكلة في الاتصال")),a.sucsses=!1,v.value=!1}catch(t){console.log(t)}finally{f.value=!1}}return j(v,t=>{t===!1&&(g.value=null,n.value=null)},{immediate:!0}),(t,e)=>{const u=U,C=S;return H(),L("div",O,[e[13]||(e[13]=s("div",{class:"main-title mb-4"},[s("h1",{class:"pb-3 pr-0"},[M(" إدارة أوقات التوصيل "),s("i",{class:"pi pi-car pr-3"})])],-1)),s("div",null,[i(r(p),{label:"إضافة وقت جديد",class:"mb-3",severity:"success",onClick:T})]),i(r(k),{visible:c.value,"onUpdate:visible":e[5]||(e[5]=o=>c.value=o),modal:"",closable:!1,style:{width:"30rem",borderRadius:"24px"}},{default:A(()=>[s("div",Y,[e[8]||(e[8]=s("label",{for:"discountValue"}," السعر *",-1)),i(u,{id:"discountValue",onKeypress:V,inputId:"integeronly",modelValue:l.value.price,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.price=o),placeholder:"ادخل السعر"},null,8,["modelValue"])]),s("div",q,[e[9]||(e[9]=s("label",{for:"time"}," وقت التوصيل ( بالدقائق ) *",-1)),i(u,{onKeypress:V,inputId:"integeronly",id:"time",modelValue:l.value.estmatedTime,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.estmatedTime=o),placeholder:"ادخل وقت التوصيل "},null,8,["modelValue"])]),s("div",z,[e[10]||(e[10]=s("label",{for:"area1"},"من منطقة *",-1)),i(C,{id:"arew1",modelValue:l.value.fromAreaId,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.fromAreaId=o),options:r(a).allArea,optionValue:"id",optionLabel:"areaName",placeholder:"اختر منطقة",class:"w-full"},null,8,["modelValue","options"])]),s("div",F,[e[11]||(e[11]=s("label",{for:"area2"},"الي منطقة *",-1)),i(C,{id:"arew2",modelValue:l.value.toAreaId,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.toAreaId=o),options:r(a).allArea,optionValue:"id",optionLabel:"areaName",placeholder:"اختر منطقة",class:"w-full"},null,8,["modelValue","options"])]),s("div",J,[i(r(p),{class:"w-100",severity:n.value===null?"success":"warning",icon:"pi pi-check",label:n.value===null?"حفظ":"تحديث",loading:f.value,onClick:h},null,8,["severity","label","loading"]),i(r(p),{class:"cancel-btn w-50",label:"إلغاء",icon:"pi pi-times pl-2",onClick:e[4]||(e[4]=o=>(c.value=!1,n.value=null))})])]),_:1},8,["visible"]),i(r(P),{value:r(a).allDelivery,rows:5,rowsPerPageOptions:[5,10,20,50],paginator:!0,class:"p-datatable-gridlines"},{default:A(()=>[i(r(y),{style:{"text-align":"start"},field:"id",header:"ID",sortable:""}),i(r(y),{style:{"text-align":"start",width:"200px"},field:"estmatedTime",header:"وقت التوصيل ( بالدقائق ) ",sortable:""}),i(r(y),{style:{"text-align":"start"},field:"price",header:"السعر",sortable:""}),i(r(y),{style:{"text-align":"start"},field:"fromArea",header:"من منطقة",sortable:""},{body:A(o=>{var m,b;return[s("span",null,D(((b=(m=o.data)==null?void 0:m.fromArea)==null?void 0:b.areaName)||" - "),1)]}),_:1}),i(r(y),{style:{"text-align":"start"},field:"toArea",header:"الي منطقة",sortable:""},{body:A(o=>{var m,b;return[s("span",null,D(((b=(m=o.data)==null?void 0:m.toArea)==null?void 0:b.areaName)||" - "),1)]}),_:1}),i(r(y),{style:{"text-align":"start"},class:"flex gap-2",header:"حذف"},{body:A(o=>[i(r(p),{label:"تعديل",icon:"pi pi-pencil",severity:"warning",class:"w-full gap-2 ml-2",onClick:m=>_(o.data)},null,8,["onClick"]),i(r(p),{label:"حذف",icon:"pi pi-trash",class:"p-button-danger w-full gap-2",onClick:m=>N(o.data.id)},null,8,["onClick"])]),_:1})]),_:1},8,["value"]),i(r(k),{visible:v.value,"onUpdate:visible":e[7]||(e[7]=o=>v.value=o),modal:"",closable:!1,style:{width:"auto",textAlign:"center",borderRadius:"24px"}},{default:A(()=>[e[12]||(e[12]=s("h1",{class:"font-bold text-xl text-enter"},"حذف رسوم التوصيل",-1)),s("p",null,"هل أنت متأكد أنك تريد حذف رسوم التوصيل بالمعرف "+D(g.value)+"؟",1),s("div",Q,[i(r(p),{class:"w-100",severity:"danger",icon:"pi pi-check",label:"تأكيد الحذف",loading:f.value,onClick:$},null,8,["loading"]),i(r(p),{class:"cancel-btn w-50",label:"إلغاء",icon:"pi pi-times pl-2",onClick:e[6]||(e[6]=o=>v.value=!1)})])]),_:1,__:[12]},8,["visible"])])}}},ke=B(W,[["__scopeId","data-v-ebefba09"]]);export{ke as default};
