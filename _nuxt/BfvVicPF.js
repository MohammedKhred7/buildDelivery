import{_ as R,a as U}from"./MniAEg5x.js";import{C as B,_ as F}from"./BtW2qkAl.js";import{_ as V}from"./CZ-5xftb.js";import q from"./C5lSkYZF.js";import{_ as E,l as G,k as M,f as Q,r as N,e as j,m as H,c as x,o as w,a as e,j as O,h as J,b as m,v as h,u as s,F as z,i as K,t as v,w as W,q as X}from"./BoVHPEzE.js";import{_ as Y,a as Z}from"./BsO-pL9M.js";import{u as tt}from"./PND9lHFW.js";import"./BNeCh_bg.js";import"./b0czaimt.js";import"./mrJBvsem.js";import"./a6yJP6gK.js";import"./Dw5OiYsV.js";import"./_6yVOD3T.js";import"./DeLV4fLb.js";import"./BrBDNSaM.js";import"./yukExd1n.js";import"./2LokmEX0.js";import"./DQUjcVE-.js";import"./DXoViBL-.js";import"./Bakru0PF.js";import"./C1NWOu8L.js";const et={class:"container-xxl py-4 pr-2 pl-2"},ot={class:"flex-column md:flex-row align-items-top row-gap-3"},st={class:"col-12 col-md-8"},nt={class:"text-center mt-4"},lt={class:"col-12 col-md-4"},rt={class:"summary-card p-4 rounded text-end"},at={class:"summary-row mb-3"},it={class:"summary-row mb-3"},mt={class:"summary-row mb-3"},ut={class:"summary-row mb-3"},dt={class:"summary-row mb-3"},ct={class:"summary-row total"},pt={key:0,class:"flex align-items-center"},_t={class:"flex justify-content-center gap-2"},ft={__name:"Cart",setup($){const l=G(),n=M(),C=Q(),D=N({price:0,estmatedTime:null,minutes:0,currency:null});j(async()=>{var t,c,a,d,i;const o=localStorage.getItem("user");if(o?n.ProfileUser=JSON.parse(o):n.ProfileUser={},((t=n.ProfileUser)==null?void 0:t.role)==="Client"&&!((c=n.DefaultLocation)!=null&&c.id)&&(n.DefaultLocation=await n.GetDefaultLocation(n.ProfileUser.id)),((a=l.items)==null?void 0:a.length)>0&&((d=n.DefaultLocation)!=null&&d.id)){let r={storeId:l.items[0].storeId,locationId:(i=n.DefaultLocation)==null?void 0:i.id};D.value=await n.GetDeliveryPriceAndTimeByAreaAndLocation(r)}});const u=H(()=>{var L;const o=l.items||[],t=Number(((L=D.value)==null?void 0:L.price)||0);let c=0,a=0,d=0,i=0;for(const b of o){const I=Number(b.quantity)||0,T=Number(b.price)||0,p=b.discountValue??0;let g=0;p>0&&p<=1?g=T*p:p>1&&p<=100?g=T*(p/100):g=Number(p)||0,c+=I,a+=T*I,d+=g*I}i=t;const f=a-d,r=f+i,y=b=>Math.round((b+Number.EPSILON)*100)/100;return{totalItems:c,totalProductPrice:y(a),totalDiscount:y(d),totalAfterDiscount:y(f),delivery:y(i),finalTotal:y(r)}}),P=o=>{l.addToCart(o)},k=o=>{l.decreaseQuantity(o==null?void 0:o.id)},S=N(null),_=N(!1),A=o=>{_.value=!0,S.value=o==null?void 0:o.id};return(o,t)=>{var i,f;const c=F,a=V,d=q;return w(),x("div",et,[t[14]||(t[14]=e("h1",{class:"mb-4 font-bold text-4xl"},"سلة المشتريات",-1)),O(e("div",ot,[e("div",st,[(w(!0),x(z,null,K(s(l).items,r=>(w(),x("div",{key:r.id,class:"mb-3"},[m(B,{product:r,onIncrease:P,onDecrease:k,onRemove:A},null,8,["product"])]))),128)),e("div",nt,[e("button",{class:"add-product-btn w-100",onClick:t[0]||(t[0]=r=>{s(C).push("/cart/add-payment")})},"الذهاب إلي الدفع")])]),e("div",lt,[e("div",rt,[t[10]||(t[10]=e("h5",{class:"font-bold mb-4"},"ملخص الطلب",-1)),e("div",at,[t[4]||(t[4]=e("span",null,"عدد المنتجات",-1)),e("span",null,v(s(u).totalItems),1)]),e("div",it,[t[5]||(t[5]=e("span",null,"إجمالي السعر قبل الخصم",-1)),e("span",null,v(s(u).totalProductPrice)+" ريـال",1)]),e("div",mt,[t[6]||(t[6]=e("span",null,"إجمالي الخصم",-1)),e("span",null,v(s(u).totalDiscount)+" ريـال ",1)]),e("div",ut,[t[7]||(t[7]=e("span",null,"إجمالي السعر بعد الخصم",-1)),e("span",null,v(s(u).totalAfterDiscount)+" ريـال ",1)]),e("div",dt,[t[8]||(t[8]=e("span",null,"رسوم التوصيل",-1)),e("span",null,v(s(u).delivery)+" ريـال",1)]),t[11]||(t[11]=e("hr",{class:"my-3"},null,-1)),e("div",ct,[t[9]||(t[9]=e("span",null,"الإجمالي",-1)),e("span",null,v(s(u).finalTotal)+" ريـال",1)])])])],512),[[h,((i=s(l).items)==null?void 0:i.length)>0]]),((f=s(l).items)==null?void 0:f.length)<=0?(w(),x("div",pt,[m(c)])):J("",!0),m(d,{visible:s(_),"onUpdate:visible":t[3]||(t[3]=r=>X(_)?_.value=r:null),closable:!1,modal:"",style:{width:"25rem",textAlign:"center",borderRadius:"24px"}},{default:W(()=>[t[12]||(t[12]=e("h1",{class:"font-bold delete-title text-enter text-900"}," حذف المنتج من السلة ",-1)),t[13]||(t[13]=e("p",{class:"p-text-secondary"}," هل أنت متأكد أنك تريد حذف هذا المنتج من سلتك ؟ ",-1)),e("div",_t,[m(a,{class:"delete-btn w-50",type:"button",label:"نعم",severity:"secondary",onClick:t[1]||(t[1]=r=>(s(l).removeFromCart(s(S)),_.value=!1))}),m(a,{class:"cancel-btn w-50",type:"button",label:"إلغاء",onClick:t[2]||(t[2]=r=>_.value=!1)})])]),_:1,__:[12,13]},8,["visible"])])}}},vt=E(ft,[["__scopeId","data-v-f68723a5"]]),yt={class:"flex flex-column gap-6"},Et={__name:"index",setup($){return tt({title:"سلة المشتريات"}),(l,n)=>{const C=R,D=vt,u=U,P=Y;return w(),x("div",null,[m(C,{id:"up"}),e("div",yt,[m(D),m(u)]),m(P,{onClicked:n[0]||(n[0]=k=>("scrollTo"in l?l.scrollTo:s(Z))("up"))})])}}};export{Et as default};
