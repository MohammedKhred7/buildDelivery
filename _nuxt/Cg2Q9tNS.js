import j from"./629PxYLJ.js";import m from"./BFVYPJnx.js";import{s as n}from"./CuS2MlYy.js";import O from"./xZbAwfj0.js";import{u as R}from"./CQnUWEIz.js";import{u as E}from"./cndIPJ1g.js";import{_ as M,s as T,k as G,r as p,K as D,c as H,a as r,b as i,d as K,w as b,u as t,o as v,f,g as w,t as N}from"./Bb97aE5h.js";import"./DMgn21Xk.js";import"./qOOUhR4r.js";import"./Dicr6Ez2.js";import"./uU7yjkyc.js";import"./DfZsQ3x7.js";import"./B0C5pUgp.js";import"./BKdQQWsH.js";import"./BJrxW_Ap.js";import"./D9qCAiQ_.js";import"./B1PJlvnJ.js";import"./Cxdb2A3_.js";import"./D2XgM05D.js";import"./B2qOkag5.js";import"./BtVGDGsy.js";import"./0vrLlEg9.js";import"./Dcue-zDK.js";import"./M6BZ7ffa.js";import"./8RuOjkVq.js";import"./BgMdS0fL.js";import"./BORX7aaH.js";const q={class:"py-6 pr-6 pl-6"},z={class:"flex justify-content-center gap-2"},F={class:"flex justify-content-center gap-2"},J={class:"flex justify-content-center gap-2"},L={__name:"stores",setup(Q){R({title:"إدارة المتاجر"});const s=E(),{errorMessage:C,success:$}=T();G(async()=>{s.GetAllStore()});const g=p(!1),u=p(null),S=p(null);async function A(a){S.value=a;let e=await s.allStore.findIndex(l=>l.id===a);u.value=e,g.value=!0}const y=p(!1),o=p(null);async function B(a){o.value={...a};let e=await s.allStore.findIndex(l=>{var c;return l.id===((c=o.value)==null?void 0:c.id)});u.value=e,y.value=!0}const d=p(!1);async function U(){var a;d.value=!0;try{o.value.isOpen=!((a=o.value)!=null&&a.isOpen),await s.PutCreateStore(o.value),s.sucsses?($("تم تعديل نوع المتجر  بنجاح"),s.allStore.splice(u.value,1,o.value)):C("مشكلة في الاتصال"),s.sucsses=!1,y.value=!1}catch(e){console.log(e)}finally{d.value=!1}}const x=p(!1),k=p("");async function h(a,e){o.value={...a};let l=await s.allStore.findIndex(c=>{var _;return c.id===((_=o.value)==null?void 0:_.id)});switch(u.value=l,e){case 0:k.value=null;break;case 1:k.value="هل تريد تغير حالة المتجر الي (قبول) ";break;case 2:k.value="هل تريد تغير حالة المتجر الي (رفض) ";break}x.value=!0}async function I(a){var e;d.value=!0;try{let l=0;a?l=a:s.allStore[u.value].storeStatus===1?l=2:l=1,await s.UpdateStoreStatus((e=o.value)==null?void 0:e.id,l),s.sucsses?($("تم تعديل حالة المتجر  بنجاح"),o.value.storeStatus=l,s.allStore.splice(u.value,1,o.value)):C("مشكلة في الاتصال"),s.sucsses=!1,x.value=!1}catch(l){console.log(l)}finally{d.value=!1}}async function V(){d.value=!0;try{u.value!==null&&(await s.DeleteStore(S.value),s.sucsses?($("تم حذف المتجر  بنجاح"),s.allStore.splice(u.value,1)):C("مشكلة في الاتصال")),s.sucsses=!1,g.value=!1}catch(a){console.log(a)}finally{d.value=!1}}return D(y,a=>{a===!1&&(o.value=null,u.value=null)}),D(x,a=>{a===!1&&(o.value=null,u.value=null)}),D(g,a=>{a===!1&&(S.value=null,u.value=null)}),(a,e)=>(v(),H("div",q,[e[13]||(e[13]=r("div",{class:"main-title mb-4"},[r("h1",{class:"pb-3 pr-0"},[K(" إدارة المتاجر "),r("i",{class:"pi pi-shop pr-3"})])],-1)),i(t(j),{value:t(s).allStore,rows:5,rowsPerPageOptions:[5,10,20,50],paginator:!0,class:"p-datatable-gridlines"},{default:b(()=>[i(t(m),{style:{"text-align":"start"},field:"id",header:"ID",sortable:""}),i(t(m),{style:{"text-align":"start"},field:"name",header:"اسم المتجر",sortable:""}),i(t(m),{style:{"text-align":"start","max-width":"200px"},field:"description",header:"الوصف",sortable:""}),i(t(m),{style:{"text-align":"start"},field:"areaName",header:"المنطقة",sortable:""}),i(t(m),{style:{"text-align":"start",width:"150px"},field:"isOpen",header:"مفتوح / مغلق",sortable:""},{body:b(l=>[l.data.isOpen===!1?(v(),f(t(n),{key:0,label:"مغلق",severity:"danger",onClick:c=>B(l.data)},null,8,["onClick"])):w("",!0),l.data.isOpen?(v(),f(t(n),{key:1,label:"مفتوح",severity:"success",onClick:c=>B(l.data)},null,8,["onClick"])):w("",!0)]),_:1}),i(t(O),{visible:y.value,"onUpdate:visible":e[1]||(e[1]=l=>y.value=l),modal:"",closable:!1,style:{width:"20rem",textAlign:"center",borderRadius:"24px"}},{default:b(()=>[e[9]||(e[9]=r("h1",{class:"font-bold text-xl text-enter"},"نوع المتجر ",-1)),e[10]||(e[10]=r("p",null,"هل أنت متأكد أنك تريد تغير نوع المتجر ؟",-1)),r("div",z,[i(t(n),{class:"w-100",severity:"success",icon:"pi pi-check",loading:d.value,label:"التحديث",onClick:U},null,8,["loading"]),i(t(n),{class:"cancel-btn w-100",label:"إلغاء",icon:"pi pi-times pl-2",onClick:e[0]||(e[0]=l=>y.value=!1)})])]),_:1,__:[9,10]},8,["visible"]),i(t(m),{style:{"text-align":"start",width:"170px"},field:"storeStatus",header:"الحالة",sortable:""},{body:b(l=>[l.data.storeStatus===0?(v(),f(t(n),{key:0,label:"قيد المراجعة",severity:"warning",onClick:c=>h(l.data,0)},null,8,["onClick"])):w("",!0),l.data.storeStatus===1?(v(),f(t(n),{key:1,label:"مرفوض",severity:"danger",onClick:c=>h(l.data,1)},null,8,["onClick"])):w("",!0),l.data.storeStatus===2?(v(),f(t(n),{key:2,label:"تم القبول",severity:"success",onClick:c=>h(l.data,2)},null,8,["onClick"])):w("",!0)]),_:1}),i(t(O),{visible:x.value,"onUpdate:visible":e[6]||(e[6]=l=>x.value=l),modal:"",closable:!1,style:{width:"20rem",textAlign:"center",borderRadius:"24px"}},{default:b(()=>[e[11]||(e[11]=r("h1",{class:"font-bold text-xl text-enter"},"حالة المتجر ",-1)),r("p",null,N(k.value||"هل أنت متأكد أنك تريد تغير حالة المتجر ؟"),1),r("div",F,[k.value?w("",!0):(v(),f(t(n),{key:0,class:"w-100",severity:"success",icon:"pi pi-check",loading:d.value,label:"قبول",onClick:e[2]||(e[2]=l=>I(2))},null,8,["loading"])),k.value?(v(),f(t(n),{key:2,class:"w-100",severity:"success",icon:"pi pi-check",loading:d.value,label:"التحديث",onClick:e[4]||(e[4]=l=>I(null))},null,8,["loading"])):(v(),f(t(n),{key:1,class:"w-100",severity:"danger",icon:"pi pi-times",loading:d.value,label:"رفض",onClick:e[3]||(e[3]=l=>I(1))},null,8,["loading"])),i(t(n),{class:"cancel-btn w-100",label:"إلغاء",icon:"pi pi-times pl-2",onClick:e[5]||(e[5]=l=>x.value=!1)})])]),_:1,__:[11]},8,["visible"]),i(t(m),{style:{"text-align":"start",width:"100px"},header:"حذف"},{body:b(l=>[i(t(n),{label:"حذف",icon:"pi pi-trash",class:"p-button-danger w-full gap-2",onClick:c=>A(l.data.id)},null,8,["onClick"])]),_:1})]),_:1},8,["value"]),i(t(O),{visible:g.value,"onUpdate:visible":e[8]||(e[8]=l=>g.value=l),modal:"",closable:!1,style:{width:"auto",textAlign:"center",borderRadius:"24px"}},{default:b(()=>[e[12]||(e[12]=r("h1",{class:"font-bold text-xl text-enter"},"حذف متجر",-1)),r("p",null,"هل أنت متأكد أنك تريد حذف المتجر بالمعرف "+N(S.value)+"؟",1),r("div",J,[i(t(n),{class:"w-100",severity:"danger",icon:"pi pi-check",label:"تأكيد الحذف",loading:d.value,onClick:V},null,8,["loading"]),i(t(n),{class:"cancel-btn w-50",label:"إلغاء",icon:"pi pi-times pl-2",onClick:e[7]||(e[7]=l=>g.value=!1)})])]),_:1,__:[12]},8,["visible"])]))}},Se=M(L,[["__scopeId","data-v-083bec94"]]);export{Se as default};
