import M from"./DDjvz5j0.js";import{_ as T,x as H,r as c,m as J,Q as O,e as Q,L as q,c as h,a as s,b as a,d as K,w as g,u as e,s as N,o as _,l as W,h as V,n as X,v as Y,J as Z,t as ee}from"./B8bw-qgz.js";import le from"./_hb0CI4I.js";import y from"./CZbfs1Tj.js";import{s as m}from"./DDyLTzb0.js";import R from"./DOnK2t2o.js";import B from"./D3z-2-VN.js";import{u as te}from"./BWrH_0R2.js";import{u as se}from"./BVGFqH36.js";import"./CElyrDPd.js";import"./BAjhaC56.js";import"./DAkP3l9d.js";import"./Dwnst9H8.js";import"./Cy8lMCAr.js";import"./C7GAp4r8.js";import"./D_nHn-NJ.js";import"./COyAXlhX.js";import"./D89hGFUH.js";import"./Dz-7mMxJ.js";import"./CdANXqyF.js";import"./tnWtlJkU.js";import"./DKS4LJ3o.js";import"./CG77IQb3.js";import"./BqAhhW5w.js";import"./BawmCFSI.js";import"./Bq9Wevo-.js";import"./D2zh2Ohw.js";import"./F-oyqQTZ.js";import"./z7rOlAwU.js";import"./Be4sXn-J.js";const ae={class:"py-6 pl-6 pr-6"},ie={class:"icon-category"},oe=["src"],ne={class:"p-fluid p-0"},re={class:"flex flex-column gap-2 mb-4"},ce={class:"flex flex-column gap-2 mb-4 w-full"},de={class:"mb-4"},ue={key:0,class:"flex justify-content-center"},pe=["src"],me={key:1,class:"relative text-white mr-4",style:{top:"50px",left:"9px"}},fe={class:"flex justify-content-center gap-2"},ve={class:"flex justify-content-center gap-2 mt-4"},ge={__name:"categories",setup(ye){se({title:"إدارة التصنيفات"});const{errorMessage:I,success:k}=H(),i=te(),D=c(null),S=J(),{file:r,urlImage:$}=O(S);Q(async()=>{i.GetAllCategories()});const d=c(!1),b=c(null),x=c(null),u=c(!1),o=c({id:null,name:"",description:"",iconId:null}),f=c(null);async function F(t){o.value={...t};let l=await i.allCategories.findIndex(v=>v.id===o.value.id);r.value=null,f.value=l,u.value=!0}function A(t){r.value=t.files[0]}function z(){r.value=null}function E(){D.value.choose()}const p=c(!1);async function G(){p.value=!0;try{if(f.value===null){if(r.value){const t=await S.upladFiles(r.value);t&&(o.value.iconId=t)}await i.PostCreateCategories(o.value),i.sucsses?(k("تم إضافة التصنيف  بنجاح"),i.GetAllCategories()):I("مشكلة في الاتصال")}else{if(r.value){const t=await S.upladFiles(r.value);t&&(o.value.iconId=t)}await i.PutUpdateCategory(o.value),i.sucsses?(k("تم تعديل التصنيف  بنجاح"),i.allCategories.splice(f.value,1,{...o.value})):I("مشكلة في الاتصال")}i.sucsses=!1,u.value=!1}catch(t){console.log(t)}finally{p.value=!1}}async function L(t){x.value=t;let l=await i.allCategories.findIndex(v=>v.id===t);b.value=l,d.value=!0}async function P(){p.value=!0;try{b.value!==null&&(await i.DeleteCategory(x.value),i.sucsses?(k("تم حذف التصنيف  بنجاح"),i.allCategories.splice(b.value,1)):I("مشكلة في الاتصال")),i.sucsses=!1,d.value=!1}catch(t){console.log(t)}finally{p.value=!1}}return q(d,t=>{t===!1&&(x.value=null,b.value=null)}),(t,l)=>{const v=M;return _(),h("div",ae,[l[10]||(l[10]=s("div",{class:"main-title mb-4"},[s("h1",{class:"pb-3 pr-0"},[K(" إدارة التصنيفات "),s("i",{class:"pi pi-palette pr-3"})])],-1)),a(e(le),{value:e(i).allCategories,rows:5,rowsPerPageOptions:[5,10,20,50],paginator:!0,class:"p-datatable-gridlines"},{default:g(()=>[a(e(y),{style:{"text-align":"start"},field:"id",header:"ID",sortable:""}),a(e(y),{field:"iconId",header:"الصورة",style:{"justify-content":"center",display:"flex"}},{body:g(n=>[s("div",ie,[s("img",{src:e($)+n.data.iconId,alt:"icon",class:"w-full h-full",style:{"border-radius":"50px"}},null,8,oe)])]),_:1}),a(e(y),{style:{"text-align":"start"},field:"name",header:"اسم التصنيف",sortable:""}),a(e(y),{style:{"text-align":"start"},field:"description",header:" الوصف",sortable:""}),a(e(y),{style:{"text-align":"start"},header:"إجراء"},{body:g(n=>[a(e(m),{label:"تعديل",icon:"pi pi-pencil",severity:"warning",class:"gap-2 ml-2",onClick:w=>F(n.data)},null,8,["onClick"]),a(e(m),{label:"حذف",icon:"pi pi-trash",severity:"danger",class:"gap-2",onClick:w=>L(n.data.id)},null,8,["onClick"])]),_:1})]),_:1},8,["value"]),a(e(R),{visible:e(u),"onUpdate:visible":l[3]||(l[3]=n=>N(u)?u.value=n:null),header:e(f)===null?"إضافة تصنيف":"تعديل تصنيف",modal:"",closable:!1,style:{width:"30rem",borderRadius:"24px"}},{default:g(()=>{var n,w,U,j;return[s("div",ne,[s("div",re,[l[6]||(l[6]=s("label",{for:"categoryName pl-0 pr-0"},"اسم التصنيف",-1)),a(e(B),{id:"categoryName",class:"w-full",placeholder:"ادخل اسم التصنيف ..",modelValue:e(o).name,"onUpdate:modelValue":l[0]||(l[0]=C=>e(o).name=C)},null,8,["modelValue"])]),s("div",ce,[l[7]||(l[7]=s("label",{for:"description pl-0 pr-0"}," الوصف",-1)),a(e(B),{id:"description",class:"w-full",placeholder:"ادخل الوصف التصنيف ..",modelValue:e(o).description,"onUpdate:modelValue":l[1]||(l[1]=C=>e(o).description=C)},null,8,["modelValue"])]),s("div",de,[W(a(v,{ref_key:"uploader",ref:D,class:X(e(r)?"d-none":"justify-content-center "),name:"avatar",customUpload:"",accept:"image/*",maxFileSize:"1000000",auto:!1,multiple:!1,chooseLabel:"انقر لتحميل صورة",uploadLabel:"انقر لتحميل صورة",showUploadButton:!1,showCancelButton:!1,onSelect:A,onRemove:z},null,8,["class"]),[[Y,e(r)]]),e(r)?V("",!0):(_(),h("div",ue,[s("div",{class:"profileImage p-1",onClick:E},[(n=e(o))!=null&&n.iconId?(_(),h("img",{key:0,src:e($)+((w=e(o))==null?void 0:w.iconId),alt:"انقر لتحميل صورة",style:{"border-radius":"50%",width:"100%",height:"100%","object-fit":"cover"}},null,8,pe)):V("",!0),(U=e(o))!=null&&U.iconId?V("",!0):(_(),h("span",me,"انقر لتحميل صورة ")),s("span",{class:"iconCamera",style:Z({top:(j=e(o))!=null&&j.iconId?"-44px":"50px"})},l[8]||(l[8]=[s("i",{class:"pi pi-camera"},null,-1)]),4)])]))]),s("div",fe,[a(e(m),{label:e(f)===null?"حفظ":"تحديث",icon:"pi pi-check pl-2",class:"w-50",severity:"success",onClick:G,loading:e(p)},null,8,["label","loading"]),a(e(m),{label:"إلغاء",icon:"pi pi-times pl-2",class:"cancel-btn w-50",onClick:l[2]||(l[2]=C=>u.value=!1)})])])]}),_:1},8,["visible","header"]),a(e(R),{visible:e(d),"onUpdate:visible":l[5]||(l[5]=n=>N(d)?d.value=n:null),modal:"",closable:!1,style:{width:"auto",textAlign:"center",borderRadius:"24px"}},{default:g(()=>[l[9]||(l[9]=s("h1",{class:"font-bold text-xl mb-2"},"حذف تصنيف",-1)),s("p",null,"هل أنت متأكد أنك تريد حذف تصنيف بالمعرف "+ee(e(x))+"؟",1),s("div",ve,[a(e(m),{label:"تأكيد الحذف",icon:"pi pi-check",severity:"danger",class:"w-100",onClick:P,loading:e(p)},null,8,["loading"]),a(e(m),{label:"إلغاء",icon:"pi pi-times pl-2",class:"cancel-btn w-50",onClick:l[4]||(l[4]=n=>d.value=!1)})])]),_:1,__:[9]},8,["visible"])])}}},qe=T(ge,[["__scopeId","data-v-7b356d24"]]);export{qe as default};
